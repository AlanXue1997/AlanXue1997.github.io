<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-Hans"><generator uri="https://jekyllrb.com/" version="3.8.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="zh-Hans" /><updated>2018-12-04T14:02:23+08:00</updated><id>http://localhost:4000/</id><title type="html">Alan Xue’s blog</title><subtitle>Alan Xue's Blog
</subtitle><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><entry><title type="html">深度学习服务器Docker配置及基本用法</title><link href="http://localhost:4000/2018/12/03/docker.html" rel="alternate" type="text/html" title="深度学习服务器Docker配置及基本用法" /><published>2018-12-03T00:00:00+08:00</published><updated>2018-12-03T00:00:00+08:00</updated><id>http://localhost:4000/2018/12/03/docker</id><content type="html" xml:base="http://localhost:4000/2018/12/03/docker.html">&lt;p&gt;如果你不安装，只是想使用服务器上的Docker，可以直接跳到&lt;a href=&quot;#使用举例keras-gan&quot;&gt;使用举例——Keras-GAN&lt;/a&gt;。&lt;/p&gt;

&lt;h1 id=&quot;安装docker&quot;&gt;安装Docker&lt;/h1&gt;

&lt;p&gt;系统：CentOS 7
内核要求：3.10以上（可用uname -r命令检查）&lt;/p&gt;

&lt;p&gt;确保yum是最新&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo yum update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;下载、执行安装脚本&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;!--more--&gt;

&lt;p&gt;启动Docker进程&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl start docker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;验证Docker是否安装成功并在容器中执行一个测试的镜像&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker run hello-world
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;会输出很多东西，有两行是这样说的：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hello from Docker!
This message shows that your installation appears to be working correctly.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;这就说明安装没问题了。&lt;/p&gt;

&lt;p&gt;转移数据目录
Docker的数据目录默认位于&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/lib/docker&lt;/code&gt;，里面会存储着Docker镜像的数据。如果其所在的硬盘分区空间较小，可以将其转移到大的磁盘分区。实验室的机子我看根目录/挂载在一个50G的小硬盘上，/home目录挂载在1.8T大硬盘上，所以将其转移到/home目录下。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service docker stop
mkdir /home/cuda/dockerData(cuda是用户名）
sudo mv /var/lib/docker /home/cuda/dockerData
sudo ln -s /home/cuda/dockerData/docker /var/lib/docker
sudo service docker start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;安装nvidia-docker&quot;&gt;安装Nvidia-Docker&lt;/h1&gt;

&lt;h2 id=&quot;安装nvidia显卡驱动&quot;&gt;安装Nvidia显卡驱动&lt;/h2&gt;
&lt;p&gt;在安装Nvidia-Docker前，发现这个服务器居然没有Nvidia显卡驱动。&lt;/p&gt;

&lt;p&gt;装显卡驱动&lt;/p&gt;

&lt;p&gt;在&lt;a href=&quot;https://www.nvidia.com/Download/index.aspx&quot;&gt;官网&lt;/a&gt;搜索对应的驱动下载即可，linux下载到的是&lt;code class=&quot;highlighter-rouge&quot;&gt;.run&lt;/code&gt;文件。（如果你不会的话，可以用pscp命令把它传到服务器）&lt;/p&gt;

&lt;p&gt;运行安装命令&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo sh ***.run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;安装时会报错：You appear to be running an X server; please exit X before…&lt;/p&gt;

&lt;p&gt;关闭这个X即可，有两种可能，gdm和lightdm&lt;/p&gt;

&lt;p&gt;分别尝试&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service gdm status
sudo service lightdm status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;如果其中一个是能够查到的，就用对应命令关掉&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service gdm stop
sudo service lightdm stop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;之后，又会出错：The Nouveau kernel driver is currently in use by your system…&lt;/p&gt;

&lt;p&gt;这里就是需要关掉这个Nouveau驱动了，需要两步&lt;/p&gt;

&lt;p&gt;(1)把驱动加入黑名单
编辑/etc/modprobe.d/blacklist.conf，在文件后面加入blacklist nouveau&lt;/p&gt;

&lt;p&gt;(2)root权限运行如下命令
sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak
sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r)&lt;/p&gt;

&lt;p&gt;以上两条命令分别是备份与重建initramfs（这里我看不懂，但是这两条如果不运行的话是不会成功的）&lt;/p&gt;

&lt;h2 id=&quot;真的开始安装nvidia-docker&quot;&gt;真的开始安装Nvidia-Docker&lt;/h2&gt;
&lt;p&gt;根据官方教程，先要添加RHEL-based distributions（注意这里只针对CentOS 7，其他系统可能有区别）&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.repo | \
  sudo tee /etc/yum.repos.d/nvidia-docker.repo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;安装&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo yum install nvidia-docker2
sudo pkill -SIGHUP dockerd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;至此安装结束，再次打开docker服务&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service docker start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后检验是否安装成功&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker run --runtime=nvidia --rm nvidia/cuda nvidia-smi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;在一通下载解压之后，最终输出显卡信息，就是类似&lt;code class=&quot;highlighter-rouge&quot;&gt;nvidia-smi&lt;/code&gt;命令的结果，就说明安装成功。&lt;/p&gt;

&lt;h2 id=&quot;验证容器能否运行tensorflow&quot;&gt;验证容器能否运行TensorFlow&lt;/h2&gt;

&lt;p&gt;CPU版&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker run -it --rm tensorflow/tensorflow \
    python -c &quot;import tensorflow as tf; print(tf.__version__)&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;最终输出tensorflow的版本：1.12.0（可能更高）就说明运行成功&lt;/p&gt;

&lt;p&gt;GPU版&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker run --runtime=nvidia -it --rm tensorflow/tensorflow:latest-gpu \
    python -c &quot;import tensorflow as tf; print(tf.contrib.eager.num_gpus())&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;看看里面的输出，没有报错信息就没什么问题了。&lt;/p&gt;

&lt;h1 id=&quot;使用举例keras-gan&quot;&gt;使用举例——Keras-GAN&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eriklindernoren/Keras-GAN&quot;&gt;Keras-GAN&lt;/a&gt;是一个使用Keras框架来实现各个论文里的GAN的github项目。&lt;/p&gt;

&lt;p&gt;将Keras-GAN从github上clone到服务器上（任意目录），然后开始配环境。&lt;/p&gt;

&lt;p&gt;首先，在&lt;a href=&quot;https://hub.docker.com/&quot;&gt;Docker Hub&lt;/a&gt;上pull一个keras的镜像，这里使用了tag：2.1.4-py3-tf-gpu，因为Keras-GAN要求python3，另外这次希望运行gpu版的tensorflow。（如果你在使用的时候找不到恰好的，可以挑个更底层的，比如直接pull一个ubuntu，然后自己配里面的环境）&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker pull gw000/keras:2.1.4-py3-tf-gpu
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Docker Hub is a cloud-based registry service which allows you to link to code repositories, build your images and test them, stores manually pushed images, and links to Docker Cloud so you can deploy images to your hosts. It provides a centralized resource for container image discovery, distribution and change management, user and team collaboration, and workflow automation throughout the development pipeline.
可以简单理解为：我们可以直接从Docker Hub上pull各种各样别人配好的环境（镜像）到本地&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;接下来，使用&lt;code class=&quot;highlighter-rouge&quot;&gt;keras run&lt;/code&gt;来运行&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker run -it -v $(pwd)/Keras-GAN:/src/Keras-GAN -w /src gw000/keras:2.1.4-py3-tf-gpu
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;说明一下这个命令：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt; &lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-i&lt;/td&gt;
      &lt;td&gt;以交互模式运行容器，通常与 -t 同时使用&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-t&lt;/td&gt;
      &lt;td&gt;为容器重新分配一个伪输入终端，通常与 -i 同时使用&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-it&lt;/td&gt;
      &lt;td&gt;等价于 -i -t&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-v&lt;/td&gt;
      &lt;td&gt;将主机中当前目录下的Keras-GAN挂载到容器的/src/Keras-GAN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;-w&lt;/td&gt;
      &lt;td&gt;指定容器的/src目录为工作目录&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;如果运行成功，那么端口的命令行开头应该变成如下形式&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ID:/src（例如root@0308dc20a66b:/src)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;之后在这里面进行常规的操作，先安装requirement&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd Keras-GAN/
pip3 install -r requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;而后，可以随便跑一种模型，我就直接选择了最基础的&lt;a href=&quot;https://github.com/eriklindernoren/Keras-GAN#gan&quot;&gt;GAN&lt;/a&gt;来跑。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd gan/
python3 gan.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;第一次运行时还出现在数据下载失败的问题，不清楚这是偶然现象还是固有问题，我进python终端手写了那两行代码，数据下载没出错。具体如下：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ python3（进python的命令行）
&amp;gt;&amp;gt;&amp;gt; from keras.datasets import mnist
&amp;gt;&amp;gt;&amp;gt; mnist.load_data() 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;之后再运行gan，就成功了。下面是保存的最后一张图像（第29800次迭代）&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/docker-1.png&quot; alt=&quot;docker-1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;至此，就可以exit退出虚拟终端了。但这个容器还是保留着的。&lt;/p&gt;

&lt;p&gt;这个容器可以有几种选择：
如果以后用不到了，直接把容器删掉即可
如果以后还需要用，可以保留，之后用下面的命令进入&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker start eafd9111ada6                # 启动容器
sudo docker exec -it eafd9111ada6  /bin/bash  # 进入容器
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;如果这个环境比较好，想要保留，以后用到别的项目，可以用commit命令创建镜像。具体参考&lt;a href=&quot;http://www.runoob.com/w3cnote/docker-use-container-create-image.html&quot;&gt;Docker 使用容器来创建镜像&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;删除镜像容器&quot;&gt;删除镜像、容器&lt;/h1&gt;

&lt;p&gt;注意顺序，删除一个镜像前，先删除由它建立的容器。&lt;/p&gt;

&lt;p&gt;检查所有容器&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker ps -a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;看到想删除的容器后，删除&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker rm ***(CONTAINER ID)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在对应容器都删除后，查看镜像&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker images
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;然后依然是根据ID来进行删除，但注意这次不是&lt;code class=&quot;highlighter-rouge&quot;&gt;rm&lt;/code&gt;，而是&lt;code class=&quot;highlighter-rouge&quot;&gt;rmi&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo docker rmi ***(IMAGE ID)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="Linux" /><category term="Docker" /><category term="机器学习" /><category term="配环境" /><summary type="html">如果你不安装，只是想使用服务器上的Docker，可以直接跳到使用举例——Keras-GAN。 安装Docker 系统：CentOS 7 内核要求：3.10以上（可用uname -r命令检查） 确保yum是最新 sudo yum update 下载、执行安装脚本 curl -fsSL https://get.docker.com -o get-docker.sh sudo sh get-docker.sh</summary></entry><entry><title type="html">LEGO-NXT解魔方</title><link href="http://localhost:4000/2018/08/27/nxt-rubik.html" rel="alternate" type="text/html" title="LEGO-NXT解魔方" /><published>2018-08-27T00:00:00+08:00</published><updated>2018-08-27T00:00:00+08:00</updated><id>http://localhost:4000/2018/08/27/nxt-rubik</id><content type="html" xml:base="http://localhost:4000/2018/08/27/nxt-rubik.html">&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;很久以前就知道LEGO-NXT可以解魔方，但网上最经典的解决方法需要用到RGB模块，这个模块在机器人套装中没有，单独购买还挺贵。除此之外，也能见到有些人用手机来识别魔方的颜色，但由于自己当时编程能力有限，也就没有去做。&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;在上一篇博文中，我学会了如何使用Python来控制NXT。有了Python之后，就感觉此事，有戏。因为有了Python作为桥梁，大多数问题都可以同过import来解决😂。&lt;/p&gt;

&lt;p&gt;进入正文之前，首先看一下最终效果&lt;/p&gt;

&lt;embed src=&quot;http://player.youku.com/player.php/sid/XMzgwMjIyMDQyMA==/v.swf&quot; allowfullscreen=&quot;true&quot; quality=&quot;high&quot; width=&quot;480&quot; height=&quot;400&quot; align=&quot;middle&quot; allowscriptaccess=&quot;always&quot; type=&quot;application/x-shockwave-flash&quot; /&gt;

&lt;p&gt;这篇文章旨在向同样想使用NXT解魔方的人提供一些&lt;strong&gt;思路和方法，不会特别全面&lt;/strong&gt;。&lt;/p&gt;

&lt;p class=&quot;success&quot;&gt;如果大家遇到了其他的问题或想要知道更多的细节，欢迎留言告知。&lt;/p&gt;

&lt;h1 id=&quot;准备工作&quot;&gt;准备工作&lt;/h1&gt;

&lt;h2 id=&quot;nxt机器人&quot;&gt;NXT机器人&lt;/h2&gt;

&lt;p&gt;机器人最大的作用是拧魔方，还有一个附带的作用是展示魔方的每一面，以方便识别颜色。&lt;/p&gt;

&lt;p&gt;我直接使用了&lt;a href=&quot;http://mindcuber.com/mindcuber/mindcuber.html&quot;&gt;MindCuber for LEGO MINDSTORMS NXT 2.0&lt;/a&gt;的设计，这个设计十分巧妙且经典，用两个电机就能完成魔方的所有操作。不过，由于我们并不打算使用RGB感应器来识别颜色，因此右侧那一坨（最右侧的电机及以上）不需要安装。如果像我一样比较懒，超声波部分也不需要安装。&lt;/p&gt;

&lt;p&gt;我拥有的是LEGO 9797+9695，这里面有的部件数量不满足MindCuber for LEGO MINDSTORMS NXT 2.0的要求，所有拼的时候灵活一些，遇见不够了就拿别的代替就好了。&lt;/p&gt;

&lt;p class=&quot;info&quot;&gt;提示：尽量多代替底部支架部分，少代替顶部的机械臂。&lt;/p&gt;

&lt;h2 id=&quot;手机&quot;&gt;手机&lt;/h2&gt;

&lt;p&gt;手机需要安装一个叫IP Webcam的APP，免费的版本就可以。&lt;/p&gt;

&lt;p&gt;打开软件后滑到最底部点击start server，则软件开始运行，屏幕下方会显示服务器的地址即端口号，例如我的是&lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.0.101:8080&lt;/code&gt;，此时，使用电脑（同一个子网，或者说路由器内）浏览器访问网址&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;地址:端口号/shot.jpg
（例如192.168.0.101:8080/shot.jpg）
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果显示出了手机及时拍摄的照片，则说明手机部分没有问题。&lt;/p&gt;

&lt;h2 id=&quot;python&quot;&gt;Python&lt;/h2&gt;

&lt;p&gt;推荐使用Python2.7。如果使用其他版本，主要的阻碍在nxt-python，如果其能够正常工作，则其他的问题应该不难解决。下面是一些包&lt;/p&gt;

&lt;h3 id=&quot;nxt-python&quot;&gt;nxt-python&lt;/h3&gt;

&lt;p&gt;通过这个包控制NXT机器人。安装方法见&lt;a href=&quot;http://alanxue1997.github.io/2018/08/16/nxt-python.html&quot;&gt;使用python控制LEGO-NXT（Win10）&lt;/a&gt;。&lt;/p&gt;

&lt;h3 id=&quot;urllib&quot;&gt;urllib&lt;/h3&gt;

&lt;p&gt;通过这个包来访问手机上的IP WebCame，Python2.7已内置。&lt;/p&gt;

&lt;h3 id=&quot;opencv--numpy&quot;&gt;opencv &amp;amp;&amp;amp; numpy&lt;/h3&gt;

&lt;p&gt;处理图像难免会用到的两个包。&lt;/p&gt;

&lt;p&gt;opencv在这个&lt;a href=&quot;https://www.lfd.uci.edu/~gohlke/pythonlibs/#opencv&quot;&gt;网站&lt;/a&gt;找到想要的版本，下载whl文件，之后执行&lt;code class=&quot;highlighter-rouge&quot;&gt;pip install xxx.whl&lt;/code&gt;即可。&lt;/p&gt;

&lt;p&gt;numpy已经安装太久记不清，估计直接&lt;code class=&quot;highlighter-rouge&quot;&gt;pip install numpy&lt;/code&gt;就行。&lt;/p&gt;

&lt;h3 id=&quot;kociemba&quot;&gt;kociemba&lt;/h3&gt;

&lt;p&gt;这个包用来计算魔方的解法，可以不用或换别的。安装的时候&lt;strong&gt;一定要&lt;/strong&gt;按照&lt;a href=&quot;https://github.com/muodov/kociemba&quot;&gt;Github主页&lt;/a&gt;的教程来，特别提醒需要先安装Installation后半部分的build tools，再执行pip安装。&lt;/p&gt;

&lt;h1 id=&quot;编程&quot;&gt;编程&lt;/h1&gt;

&lt;p&gt;如果前面的准备工作都已经完成，则你将完全可以使用不超过300行的代码，使NXT机器人成功还原魔方！&lt;/p&gt;

&lt;p&gt;下面将分为3个部分给出编程的思路及提示。&lt;/p&gt;

&lt;h2 id=&quot;nxt机器人-1&quot;&gt;NXT机器人&lt;/h2&gt;

&lt;p&gt;机器人部分的编程就是控制电机，拧魔方。&lt;/p&gt;

&lt;p&gt;具体到MindCuber for LEGO MINDSTORMS NXT 2.0而言，就是控制两个电机。其中底部的电机比较简单，电机上和底座上的齿轮分别由12齿和36齿，也就是3：1的转速，因此如果想要魔方旋转90度，则需要电机（反方向）旋转270度。&lt;/p&gt;

&lt;p&gt;我们可以使用如下的方式旋转&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;brick&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_one_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'NXT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Motor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PORT_A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;270&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这个写法会使PORT_A连接的电机以50的正向速度旋转270度。如果想要反向旋转，则应该把速度改为-50，而非角度改为-270。&lt;/p&gt;

&lt;p&gt;不过，使用这个方法进行旋转并不是十分精确，可能会有几度的偏差，如果多旋转几次，偏差可能会越来越大。不过，NXT的电机还有读取角度的功能，这样，我们就可以不使用相对角度，转而使用绝对角度。即记录一个变量now_degree，表示电机应该处在的角度，然后通过它与电机实际读数的差值进行旋转。例如，第一次旋转270度，实际上转了275度，第二次又要转270度，经过计算，now_degree应该是540度，差值为265度，则这次只需要转265度就行了。这样子偏差始终都能在一个可控范围。&lt;/p&gt;

&lt;p&gt;除了底部，还有一个控制机械臂的电机，这个电机主要在三个角度之间来回切换，仍然推荐使用绝对角度，角度值可以自己试出来。如果不知道机械臂的三种状态长什么样子，可以看&lt;a href=&quot;http://mindcuber.com/mindcuber/mindcuber.html&quot;&gt;MindCuber for LEGO MINDSTORMS NXT 2.0&lt;/a&gt;网站上的视频。&lt;/p&gt;

&lt;p&gt;在基础的旋转搞定之后，推荐将机器人封装成五种（或以上）操作，这样后面的编程就不用再思考这里的细节了。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;名称&lt;/th&gt;
      &lt;th&gt;具体操作&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;翻转&lt;/td&gt;
      &lt;td&gt;对应机械臂的两步操作&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;整体旋转（顺时针）&lt;/td&gt;
      &lt;td&gt;机械臂抬起，底座旋转&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;整体旋转（逆时针）&lt;/td&gt;
      &lt;td&gt;机械臂抬起，底座旋转&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;单面旋转（顺时针）&lt;/td&gt;
      &lt;td&gt;机械臂放下，底座旋转&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;单面旋转（逆时针）&lt;/td&gt;
      &lt;td&gt;机械臂放下，底座旋转&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;颜色获取&quot;&gt;颜色获取&lt;/h2&gt;

&lt;h3 id=&quot;一些废话可跳过&quot;&gt;一些废话（可跳过）&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;书到用时方恨少，事非经过不知难&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;大家或许都看到过这样的图片，A和B区域的颜色其实是一样的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rubik-1.jpg&quot; alt=&quot;rubik-1&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;第一次看到这样的图片还觉得，人类果然还是没有机器客观准确啊。&lt;/p&gt;

&lt;p&gt;但是，这次问题是反过来的，如果你要识别这个棋盘的颜色，拍照的时候因为有个圆柱挡了点光，然后电脑硬说A和B颜色一样，你就会发现电脑愚钝死板了！&lt;/p&gt;

&lt;p&gt;在识别魔方颜色上我就遇到了这样的问题，最容易出问题的就是&lt;strong&gt;橙色&lt;/strong&gt;和&lt;strong&gt;红色&lt;/strong&gt;，在太阳光下还好，如果在台灯下，就会经常出现“远处深红近处橙”的现象。&lt;/p&gt;

&lt;p&gt;由于图像方面我不甚了解，最终也没有太好的解决方法，只能是写了一个自动重设颜色的函数：按顺序把魔方的六种颜色放在魔方的同一个面里，然后拍一张照片计算颜色，并保存。&lt;/p&gt;

&lt;h3 id=&quot;正文&quot;&gt;正文&lt;/h3&gt;

&lt;p&gt;颜色获取的第一步是&lt;strong&gt;定位&lt;/strong&gt;，魔方每一面都有九个方块，我们需要先找到这九个方块在哪里。&lt;/p&gt;

&lt;p&gt;我的思路非常简单粗暴，虽然每次拍摄魔方的位置都有些许变化，但大致位置相同，因此直接把位置写成固定的，然后等间隔地选取九个小方块即可。如图&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rubik-2.png&quot; alt=&quot;rubik-2&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rubik-3.png&quot; alt=&quot;rubik-3&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;当然，此时我们不能完全相信小方块中的所有颜色，或者它们的均值，因为有些像素是不属于魔方的。&lt;/p&gt;

&lt;p&gt;如果我们事先知道魔方的六种颜色的rgb值，则可以设置一个阈值$\epsilon$，然后对每一种颜色计算&lt;strong&gt;距离小于$\epsilon$&lt;/strong&gt;的像素的个数，哪种颜色多就认为是哪种颜色，写成优化问题就是&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mathop{\arg\max}_{color} |\{pixel|\Vert pixel-color\Vert_2 \le \epsilon\}|&lt;/script&gt;

&lt;p&gt;说起来复杂，其实计算起来一句话就搞定，$\epsilon$大概设50左右，可以多试试调整，下面这句话，可以计算sub_window所有像素中与第m种颜色相近的个数。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub_window&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;至此，唯一的问题就变成了如何事先知道六种颜色的rgb值。由于我们这种方法非常受光线的影响，可能下午三点的rgb值到了下午五点就不好用了，因此我们需要一个快捷的获取六种rgb值的方法。&lt;/p&gt;

&lt;p&gt;我的做法是把魔方的六种颜色按照固定顺序展示在同一面上，然后尽量摆正，让小方块里全是同一种颜色，然后写一个代码自动获取六种颜色的均值，并存储即可，如图&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rubik-4.png&quot; alt=&quot;rubik-4&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;获取到的颜色为&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/rubik-5.png&quot; alt=&quot;rubik-5&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看出，这次获取到的颜色已经与之前有不同了。接下来使用&lt;code class=&quot;highlighter-rouge&quot;&gt;np.save&lt;/code&gt;将六种颜色保存起来即可。&lt;/p&gt;

&lt;h2 id=&quot;魔方朝向&quot;&gt;魔方朝向&lt;/h2&gt;

&lt;p&gt;除了NXT机器人和颜色获取之外，再有值得一提的就是魔方朝向了。kociemba的输出是一个如下的字符串&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;F R' L' B' L' D' F U' D2 B2 R' U L2 U2 F2 B2 R2 B2 U2 B2 U'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;六个子母分别代表六个面，正常是顺时针90度，带&lt;code class=&quot;highlighter-rouge&quot;&gt;'&lt;/code&gt;是逆时针90度，带&lt;code class=&quot;highlighter-rouge&quot;&gt;2&lt;/code&gt;是180度。&lt;/p&gt;

&lt;p&gt;我们的机器人只能拧底下的面，因此如果需要拧别的面，就需要先把那一面挪到底下，这就要求机器人能够做到两件事：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;时刻清楚每一面的位置&lt;/li&gt;
  &lt;li&gt;能够把任意一面挪到底下&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;对于第一件事，如果熟悉&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E7%BD%AE%E6%8F%9B&quot;&gt;置换&lt;/a&gt;的概念，则不难实现，如果不熟悉，直接看下面的代码，应该也能理解&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'U'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'R'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'F'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'D'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'L'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'B'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# 初始朝向&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# 机械臂翻转魔方时调整朝向&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;至于&lt;code class=&quot;highlighter-rouge&quot;&gt;URFDLB&lt;/code&gt;这个顺序，以及他们的具体意义，可以参考下图&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;             |************|
             |*U1**U2**U3*|
             |************|
             |*U4**U5**U6*|
             |************|
             |*U7**U8**U9*|
             |************|
 ************|************|************|************
 *L1**L2**L3*|*F1**F2**F3*|*R1**R2**R3*|*B1**B2**B3*
 ************|************|************|************
 *L4**L5**L6*|*F4**F5**F6*|*R4**R5**R6*|*B4**B5**B6*
 ************|************|************|************
 *L7**L8**L9*|*F7**F8**F9*|*R7**R8**R9*|*B7**B8**B9*
 ************|************|************|************
             |************|
             |*D1**D2**D3*|
             |************|
             |*D4**D5**D6*|
             |************|
             |*D7**D8**D9*|
             |************|
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;详情在&lt;a href=&quot;https://github.com/muodov/kociemba&quot;&gt;kociemba的主页&lt;/a&gt;上。&lt;/p&gt;

&lt;p&gt;对于第二件事，想要把某个面挪到底下，只要机器人能够知道这个面现在在哪，则挪过去的动作可以提前写好，一共才六种情况。&lt;/p&gt;

&lt;h2 id=&quot;示例代码&quot;&gt;示例代码&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/AlanXue1997/95d1c8af8bf3179bb444ba82f80d17a5&quot;&gt;motors.py&lt;/a&gt;是里面实现了控制机器人所需的方法，目前托管在GitHub Gist上。&lt;/p&gt;

&lt;p&gt;我没有将所有代码直接放在一个github仓库内，是因为我的这份代码别人直接拿来是&lt;strong&gt;一定用不了&lt;/strong&gt;的，尤其是图像的部分。当然，如果有人想要参考的话，也欢迎留言告诉我。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="NXT" /><category term="python" /><category term="魔方" /><summary type="html">前言 很久以前就知道LEGO-NXT可以解魔方，但网上最经典的解决方法需要用到RGB模块，这个模块在机器人套装中没有，单独购买还挺贵。除此之外，也能见到有些人用手机来识别魔方的颜色，但由于自己当时编程能力有限，也就没有去做。</summary></entry><entry><title type="html">使用python控制LEGO-NXT（Win10）</title><link href="http://localhost:4000/2018/08/16/nxt-python.html" rel="alternate" type="text/html" title="使用python控制LEGO-NXT（Win10）" /><published>2018-08-16T00:00:00+08:00</published><updated>2018-08-16T00:00:00+08:00</updated><id>http://localhost:4000/2018/08/16/nxt-python</id><content type="html" xml:base="http://localhost:4000/2018/08/16/nxt-python.html">&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;LEGO NXT官方的编程语言是&lt;a href=&quot;https://en.wikipedia.org/wiki/Lego_Mindstorms_NXT#NXT-G&quot;&gt;NXT-G&lt;/a&gt;，这个语言是基于图形界面的，设计的非常适合不熟悉编程的人群使用，然而如果想编写一些较为复杂的程序，这门语言就显得及其繁杂了。因为这门语言相当于在画程序流程图，当分支变多了之后，可读性会非常差。&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;其实除了NXT-G，还有非常多的语言可以给NXT进行编程，由于我最近用Python较多，因此选择尝试通过python来控制nxt。&lt;/p&gt;

&lt;p&gt;Github上有一个&lt;a href=&quot;https://github.com/Eelviny/nxt-python&quot;&gt;nxt-python&lt;/a&gt;项目，已经八年之久了，不过作者并没有放弃，仍然在维护，本文接下来将记录我在Windows10上使用这个项目的配环境的过程。&lt;/p&gt;

&lt;h1 id=&quot;安装nxt-python&quot;&gt;安装NXT-Python&lt;/h1&gt;

&lt;p&gt;首先，注意到Github主页上作者的提示&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;DISCLAIMER: The NXT-Python v3 implementation is incomplete. Development is not active due to lack of interest. Find the latest stable version for Python2 on the releases page. Pull requests and improvements are very welcome!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;除了这里之外，作者也在不同的地方多次提到&lt;strong&gt;目前master分支的代码不好用，甚至不可用&lt;/strong&gt;，因此强烈建议安装&lt;a href=&quot;https://github.com/Eelviny/nxt-python/releases&quot;&gt;releases&lt;/a&gt;里面的版本。&lt;/p&gt;

&lt;p&gt;在写本文时，releases页面的最新版是&lt;code class=&quot;highlighter-rouge&quot;&gt;v2.2.2&lt;/code&gt;，这个版本是针对&lt;code class=&quot;highlighter-rouge&quot;&gt;python 2.6&lt;/code&gt;的，我使用的是&lt;code class=&quot;highlighter-rouge&quot;&gt;python 2.7&lt;/code&gt;，可以正常使用，但&lt;code class=&quot;highlighter-rouge&quot;&gt;python 3&lt;/code&gt;不可以。&lt;/p&gt;

&lt;p&gt;下载并解压&lt;code class=&quot;highlighter-rouge&quot;&gt;v2.2.2&lt;/code&gt;的压缩包，进入&lt;code class=&quot;highlighter-rouge&quot;&gt;nxt-python-2.2.2&lt;/code&gt;文件夹，用python2运行&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python setup.py install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;接下来，打开一个python终端，尝试import&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nxt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果能够成功import，则说明安装成功。但根据&lt;a href=&quot;https://github.com/Eelviny/nxt-python/wiki/Installation&quot;&gt;Installation Instructions&lt;/a&gt;中的内容，我们还应该安装一个连接方式，有&lt;strong&gt;USB连接&lt;/strong&gt;和&lt;strong&gt;蓝牙连接&lt;/strong&gt;两种可选，我都尝试过，不过最终选择的是USB连接。&lt;/p&gt;

&lt;p&gt;使用USB连接的话，需要安装&lt;a href=&quot;https://sourceforge.net/projects/pyusb/&quot;&gt;PyUSB&lt;/a&gt;，其安装方法与nxt-python是一样的。&lt;/p&gt;

&lt;p class=&quot;warning&quot;&gt;注意：使用USB连接的时候&lt;strong&gt;不能安装&lt;/strong&gt;&lt;a href=&quot;https://code.google.com/archive/p/pybluez/downloads&quot;&gt;PyBluez&lt;/a&gt;。&lt;/p&gt;

&lt;h1 id=&quot;测试&quot;&gt;测试&lt;/h1&gt;

&lt;p&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;nxt-python-2.2.2&lt;/code&gt;文件夹下有一个&lt;code class=&quot;highlighter-rouge&quot;&gt;examples&lt;/code&gt;文件夹，里面有一些测试代码，nxt-python的作者建议随便挑一个尝试运行，我选择的是&lt;code class=&quot;highlighter-rouge&quot;&gt;spin.py&lt;/code&gt;。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nxt.locator&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nxt.motor&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spin_around&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m_left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Motor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PORT_B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m_left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;360&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m_right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Motor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PORT_C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m_right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;360&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_one_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spin_around&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这个代码非常简单，运行时需要将NXT主机的B和C端口接上马达。如果这份代码能够运行成功，则说明nxt-python已经能够正常工作了！&lt;/p&gt;

&lt;h1 id=&quot;问题处理&quot;&gt;问题处理&lt;/h1&gt;

&lt;p&gt;下面说一下遇到问题的处理方法&lt;/p&gt;

&lt;h2 id=&quot;mindstorms-nxt-20是否工作正常&quot;&gt;MINDSTORMS NXT 2.0是否工作正常&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.lego.com/en-us/mindstorms/downloads/nxt-software-download&quot;&gt;MINDSTORMS NXT 2.0&lt;/a&gt;是官方的编程工具，使用NXT-G语言，官方不支持中文。&lt;/p&gt;

&lt;p&gt;不论是USB还是蓝牙，在检查其他问题之前，一定要保证该软件能够与NXT正常连接。&lt;/p&gt;

&lt;h2 id=&quot;检查连接方式是否安装&quot;&gt;检查连接方式是否安装&lt;/h2&gt;

&lt;p&gt;正如前文提到的，使用USB连接需要安装&lt;a href=&quot;https://sourceforge.net/projects/pyusb/&quot;&gt;PyUSB&lt;/a&gt;，使用蓝牙连接需要安装&lt;a href=&quot;https://code.google.com/archive/p/pybluez/downloads&quot;&gt;PyBluez&lt;/a&gt;。使用USB连接的时候&lt;strong&gt;不能&lt;/strong&gt;安装PyBluez。&lt;/p&gt;

&lt;h2 id=&quot;驱动是否正确&quot;&gt;驱动是否正确&lt;/h2&gt;

&lt;p&gt;不出意外的话，许多人都会碰到这个问题，PyUSB需要依赖libUSB驱动来运行（来源：&lt;a href=&quot;https://stackoverflow.com/questions/41310102/nxt-python-error-usb-core-nobackenderror&quot;&gt;nxt-python error: usb.core.NoBackendError&lt;/a&gt;），但NXT在windows10上默认的驱动是WinUSB（就是右下角能够弹出设备的那种）。&lt;/p&gt;

&lt;p&gt;因此我们需要安装&lt;a href=&quot;https://github.com/libusb/libusb&quot;&gt;libusb&lt;/a&gt;，其官方&lt;a href=&quot;https://github.com/libusb/libusb/wiki/Windows&quot;&gt;wiki&lt;/a&gt;推荐使用&lt;a href=&quot;http://zadig.akeo.ie/&quot;&gt;Zadig&lt;/a&gt;安装，我也强烈建议使用此安装方式，非常方便，且改软件是不需要安装的，不会影响系统环境。&lt;/p&gt;

&lt;p&gt;首先连接NXT，然后运行Zadig，选择&lt;code class=&quot;highlighter-rouge&quot;&gt;Options-&amp;gt;List all devices&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/nxt-python-1.png&quot; alt=&quot;swagger-1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;接着，选中NXT设备，并将Driver换成libusb，单机Replace Driver即可，换完之后如图&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/nxt-python-2.png&quot; alt=&quot;swagger-1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;此时右下角应该已经不能“弹出该设备”，但MINDSTORMS NXT 2.0仍然能正常工作。&lt;/p&gt;

&lt;p&gt;至此，我的电脑中&lt;code class=&quot;highlighter-rouge&quot;&gt;spin.py&lt;/code&gt;已经能够成功运行。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="NXT" /><category term="python" /><category term="配环境" /><summary type="html">前言 LEGO NXT官方的编程语言是NXT-G，这个语言是基于图形界面的，设计的非常适合不熟悉编程的人群使用，然而如果想编写一些较为复杂的程序，这门语言就显得及其繁杂了。因为这门语言相当于在画程序流程图，当分支变多了之后，可读性会非常差。</summary></entry><entry><title type="html">构建自己的饭店查询API</title><link href="http://localhost:4000/2018/07/30/swagger.html" rel="alternate" type="text/html" title="构建自己的饭店查询API" /><published>2018-07-30T00:00:00+08:00</published><updated>2018-07-30T00:00:00+08:00</updated><id>http://localhost:4000/2018/07/30/swagger</id><content type="html" xml:base="http://localhost:4000/2018/07/30/swagger.html">&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;夏季学期选了一门《认知服务设计与工程》，上到最后都不清楚这门课的名字到底是什么意思。不过课上学的东西倒是都很有意思，看起来很酷。&lt;/p&gt;

&lt;p&gt;这篇博文主要记录此课程的一项作业的完成过程，要求为&lt;em&gt;使用Yelp API构建一个能够显示一个饭店列表（包括名字、地址、电话）的聊天机器人&lt;/em&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;&lt;strong&gt;如果你只是想知道怎样快速写一个API出来，请直接跳到&lt;a href=&quot;#swagger&quot;&gt;Swagger&lt;/a&gt;部分。&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;api-kg&quot;&gt;API-KG&lt;/h1&gt;

&lt;p class=&quot;info&quot;&gt;提示：这个网址可能已经失效，不过这个步骤完全可以跳过&lt;/p&gt;

&lt;p&gt;API-KG的全称为API Knowledge Graph，这个名字我也不太清楚具体是什么意思。反正老师提供了一个&lt;a href=&quot;http://apikg.ngrok.io/api/docs/&quot;&gt;网址&lt;/a&gt;（这个网址只有下午1点~9点能使用，且搜不到），里面有一些功能，下面介绍我用到的&lt;/p&gt;

&lt;h2 id=&quot;查询相似api&quot;&gt;查询相似API&lt;/h2&gt;

&lt;p&gt;该方法可以根据你的（自然语言）描述来查找最相关的API，比如对于此本作业，点击Try it out&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-1.png&quot; alt=&quot;swagger-1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后输入”Building a chatbot that uses Yelp API to show list of eateries “，点击Execute即可&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-2.png&quot; alt=&quot;swagger-2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看到，一共搜出来了5个API，其中第四个是&lt;strong&gt;Yelp V3&lt;/strong&gt;，这就是我们想要用的API，记住它的id，后面的操作需要用到&lt;/p&gt;

&lt;h2 id=&quot;查询方法method&quot;&gt;查询方法（Method）&lt;/h2&gt;

&lt;p&gt;现在我们找到了我们想要的API，但是不知道具体应该使用这个API的哪个方法，这就用到了下面的方法查询&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-3.png&quot; alt=&quot;swagger-3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看到，一共搜出了5个方法，其中最后一个比较像这次作业需要的，记下它的id，下一步使用&lt;/p&gt;

&lt;h2 id=&quot;查询表达expression&quot;&gt;查询表达（Expression）&lt;/h2&gt;

&lt;p&gt;这个查询就是API-KG的精髓所在了，它能够根据你给的方法，返回给你一系列的（自然语言）表达，方便你后面训练自然语言机器人。比如对于本次作业，输入上上面查询方法找到的id&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-4.png&quot; alt=&quot;swagger-4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以看到，返回的数据里面有许多许多询问饭店的表达。&lt;/p&gt;

&lt;p&gt;至此，API-KG的使用就结束了&lt;/p&gt;

&lt;h1 id=&quot;yelp-api&quot;&gt;Yelp API&lt;/h1&gt;

&lt;p&gt;饭店的信息通过&lt;a href=&quot;https://www.yelp.com/developers&quot;&gt;Yelp&lt;/a&gt;的&lt;a href=&quot;https://www.yelp.com/developers/documentation/v3/business_search&quot;&gt;Business Search Endpoint&lt;/a&gt;来获得，它提供了一个可以根据一些参数查询饭店的API，使用起来非常方便。接下来将介绍使用该API的步骤。&lt;/p&gt;

&lt;h2 id=&quot;注册&quot;&gt;注册&lt;/h2&gt;

&lt;p&gt;首先需要在Yelp进行注册。在注册完成后，需要在&lt;a href=&quot;https://www.yelp.com/developers/v3/manage_app&quot;&gt;Manage App&lt;/a&gt;页面建立一个APP，里面的信息不是很重要，重要的是建立完成后，系统会分配一个&lt;strong&gt;API key&lt;/strong&gt;，这个key在使用API时要用到。&lt;/p&gt;

&lt;h2 id=&quot;测试&quot;&gt;测试&lt;/h2&gt;

&lt;p&gt;使用&lt;a href=&quot;https://en.wikipedia.org/wiki/CURL&quot;&gt;curl&lt;/a&gt;或&lt;a href=&quot;https://www.getpostman.com/&quot;&gt;Postman&lt;/a&gt;都可以测试API。相较而言，Postman更加方便，下面将使用Postman进行。&lt;/p&gt;

&lt;p&gt;我们查询用到的Business Search Endpoint的地址为&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://api.yelp.com/v3/businesses
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;其查询需要的参数在&lt;a href=&quot;https://www.yelp.com/developers/documentation/v3/business_search&quot;&gt;文档&lt;/a&gt;中有详细介绍，但我们此次只需用到两个，分别是location和term，表示查询的地点和类型；除此之外，我们还必须&lt;strong&gt;在headers里面加上Authorization字段&lt;/strong&gt;，其内容就是之前系统分配的API key，如图所示&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-8.png&quot; alt=&quot;swagger-4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;单机Send后，如果下方的返回信息Body有内容，则说明查询成功。&lt;/p&gt;

&lt;p class=&quot;warning&quot;&gt;注意：有一些地址查询会报错，例如Beijing！这是正常现象。&lt;/p&gt;

&lt;h1 id=&quot;witat&quot;&gt;Wit.at&lt;/h1&gt;

&lt;p&gt;Wit.ai是一个&lt;strong&gt;非常方便&lt;/strong&gt;的自然语言机器人构建平台，你所要做的，就是新建一个App，之后不断地给出表达和表达中包含的实体即可&lt;/p&gt;

&lt;h2 id=&quot;训练&quot;&gt;训练&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-5.png&quot; alt=&quot;swagger-5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如图，在输入框内打入一段表达（如果你完成了API-KG的内容，则可以直接使用最终查到的那些表达），然后通过&lt;em&gt;Add a new entity&lt;/em&gt;挑选出相应的实体，对于本次实验，我挑出了location、term、intent三个实体&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;实体&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;wit/location&lt;/td&gt;
      &lt;td&gt;地点，是wit中自带的，从第一个之后，就基本不需要你自己来挑选了，他自动挑的就非常准&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;term&lt;/td&gt;
      &lt;td&gt;食物类别，wit里本身没有，因此从第一个后，如果遇见相同的一定能自动认出来，但不同的，必须在数据很多了之后才有可能认出来&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;intent&lt;/td&gt;
      &lt;td&gt;这个表达想问什么，实际上在本次作业里没有用，当你的机器人需要处理多种查询（多种intent）的时候，它能够起到分类的作用&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;测试-1&quot;&gt;测试&lt;/h2&gt;

&lt;p&gt;当你差不多输入了一二十个数据后，这个机器人就初步能用了，点击右上角的&lt;strong&gt;Settings&lt;/strong&gt;，里面有一个cURL的例子，在这个例子的上面输入一句话，下面会生成对应的cURL语句，你可以直接使用。但我是使用Postman进行测试的，因此需要稍微调整一下格式，调整前后如图所示&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-6.png&quot; alt=&quot;swagger-6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-7.png&quot; alt=&quot;swagger-7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如果返回的结果类似下面这样，就说明成功了。&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;_text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Sushi near Tokyo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;entities&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;term&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;confidence&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.96857372653781&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sushi&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;location&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;confidence&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.93629&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Tokyo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;resolved&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;values&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Tokyo Prefecture&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grain&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;resolved&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;timezone&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Asia/Tokyo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;coords&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;35.689498901367&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;long&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;139.69171142578&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;external&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;geonames&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1850144&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Tokyo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grain&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;locality&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;resolved&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;timezone&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Asia/Tokyo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;coords&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;35.689498901367&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;long&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;139.69171142578&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;external&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;geonames&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1850147&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;intent&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;confidence&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Search4Eateries&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;msg_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0HMAPppt5JDbaWf3L&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;swagger&quot;&gt;Swagger&lt;/h1&gt;

&lt;p&gt;Swagger具体是什么，包括哪些我也不太清楚。因为我们用到的实际上只是&lt;a href=&quot;https://editor.swagger.io/&quot;&gt;Swagger Editor&lt;/a&gt;，它能够帮你做到先写好文档，再去写代码。按照课上老师的说法，这样的好处是你先做出了客户能看到的东西，这样即使客户不满意，无非就是改改文档，不费时不费力，对双方都有好处。&lt;/p&gt;

&lt;p&gt;这个东西具体的写法我没有细学，只能是照猫画虎，生搬硬套了，下面是我最终的代码&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;swagger&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;2.0&quot;&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;API for searching eateries&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;API for searching eateries&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;1.0.0&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost:5000&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;basePath&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/v1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;schemes&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;http&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;s&quot;&gt;/search&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;get the eateries information.&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;query&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;expression&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;a nature language expression.&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;get the eateries information.&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;produces&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;application/json&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;responses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;OK&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Bad request.&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;401&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Authorization information is missing or invalid.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在写完之后，如果在线编辑器没有报错，则选择&lt;code class=&quot;highlighter-rouge&quot;&gt;File-&amp;gt;Save as YAML&lt;/code&gt;将其保存成YAML即可。&lt;/p&gt;

&lt;h1 id=&quot;flask&quot;&gt;Flask&lt;/h1&gt;

&lt;p&gt;上一步完成之后，相当于完成了API的文档，至于代码，可以有非常多的选择。这里，课上要求使用Flask来实现，因为这个框架相对轻巧易学。&lt;/p&gt;

&lt;p&gt;使用&lt;a href=&quot;https://github.com/guokr/swagger-py-codegen&quot;&gt;swagger-py-codegen&lt;/a&gt;，即可自动根据yaml文件生成一个app，用法可以直接参考github主页，非常简单。话说这个东西的名字真的是难记，每次我都要搜索老半天才能找到。。。&lt;/p&gt;

&lt;p&gt;新建的app目录结构如下，运行时直接Run最下方的&lt;code class=&quot;highlighter-rouge&quot;&gt;__init__.py&lt;/code&gt;即可。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/swagger-9.png&quot; alt=&quot;swagger-9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们只需要修改&lt;code class=&quot;highlighter-rouge&quot;&gt;search.py&lt;/code&gt;即可。这个文件初始化时有一个get方法，其返回值就是API的输出。内部需要做的事就是根据args参数，再调用之前已经准备好的API，给出最终的查询结果。中间无非就是一些Flask进行HTTP访问的常规操作，不是本文的重点，就不细说了。&lt;/p&gt;

&lt;p&gt;在这里给出&lt;code class=&quot;highlighter-rouge&quot;&gt;search.py&lt;/code&gt;最终的代码&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;__future__&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;absolute_import&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;print_function&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schemas&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;expression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'expression'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# result = request.get('https://api.wit.ai/message?v=')&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'https://api.wit.ai/message'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'v'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'20180730'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'q'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expression&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Authorization'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Bearer 5******************************G'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;entities&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'entities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'entities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'value'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Missing location!'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'term'&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;term&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'entities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'term'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'value'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'term'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;term&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'https://api.yelp.com/v3/businesses/search'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Authorization'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Bearer Eq****************************************************************************************************************************Yx'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'error'&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;businesses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'businesses'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# eateries_list = [{'name':business['name'], 'address':business['display_address'], 'phone number':business['phone']} for business in businesses]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;eateries_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;business&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'address'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;business&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'phone'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;business&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'phone'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;business&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;businesses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eateries_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;run-on-server&quot;&gt;Run on Server&lt;/h1&gt;

&lt;p&gt;我在服务器上运行的方式十分简单，就是使用&lt;code class=&quot;highlighter-rouge&quot;&gt;pscp&lt;/code&gt;命令（可能需安装Putty）直接把代码上传到VPS上，然后在VPS上运行即可。如果不能直接访问，可以看一看防火墙的设置，开放一下端口。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="Swagger" /><category term="API" /><category term="Flask" /><category term="Python" /><summary type="html">前言 夏季学期选了一门《认知服务设计与工程》，上到最后都不清楚这门课的名字到底是什么意思。不过课上学的东西倒是都很有意思，看起来很酷。 这篇博文主要记录此课程的一项作业的完成过程，要求为使用Yelp API构建一个能够显示一个饭店列表（包括名字、地址、电话）的聊天机器人</summary></entry><entry><title type="html">Alan的Python笔记</title><link href="http://localhost:4000/2018/07/23/alan-Python.html" rel="alternate" type="text/html" title="Alan的Python笔记" /><published>2018-07-23T00:00:00+08:00</published><updated>2018-07-23T00:00:00+08:00</updated><id>http://localhost:4000/2018/07/23/alan-Python</id><content type="html" xml:base="http://localhost:4000/2018/07/23/alan-Python.html">&lt;p class=&quot;warning&quot;&gt;这是个笔记，并非教程。&lt;/p&gt;

&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;这里将记录个人在写Python的过程中遇到的各种问题，以及解决方法。如果大家发现哪里写错了，过时了，或有别的任何问题，欢迎在下方评论或发邮件告知。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;环境&quot;&gt;环境&lt;/h1&gt;

&lt;h2 id=&quot;安装包&quot;&gt;安装包&lt;/h2&gt;

&lt;h3 id=&quot;安装whl文件&quot;&gt;安装&lt;code class=&quot;highlighter-rouge&quot;&gt;.whl&lt;/code&gt;文件&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install xxx.whl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;文件&quot;&gt;文件&lt;/h1&gt;

&lt;h2 id=&quot;路径相关&quot;&gt;路径相关&lt;/h2&gt;

&lt;h3 id=&quot;获取所有txt文件&quot;&gt;获取所有txt文件&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;glob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glob&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;glob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;*.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;详情：&lt;a href=&quot;https://stackoverflow.com/questions/3964681/find-all-files-in-a-directory-with-extension-txt-in-python&quot;&gt;Find all files in a directory with extension .txt in Python&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;numpy&quot;&gt;NumPy&lt;/h1&gt;

&lt;h2 id=&quot;环境-1&quot;&gt;环境&lt;/h2&gt;

&lt;h3 id=&quot;importerror-numpycoremultiarray-failed-to-import&quot;&gt;ImportError: numpy.core.multiarray failed to import&lt;/h3&gt;

&lt;p&gt;将NumPy的版本从3降到了2，之后&lt;code class=&quot;highlighter-rouge&quot;&gt;import cv2&lt;/code&gt;就出现了这个错误。&lt;/p&gt;

&lt;p&gt;解决方法：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install -U numpy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;来源：&lt;a href=&quot;https://stackoverflow.com/questions/20518632/importerror-numpy-core-multiarray-failed-to-import&quot;&gt;ImportError: numpy.core.multiarray failed to import&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ndrray&quot;&gt;ndrray&lt;/h2&gt;

&lt;h3 id=&quot;赋值慢&quot;&gt;赋值慢&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;for loop&lt;/em&gt; is &lt;strong&gt;always&lt;/strong&gt; slower than you think!!!&lt;/p&gt;

&lt;p&gt;在写一个处理Kinect v2的数据的代码的时候，写出了这样的代码&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;424&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;424&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这次的程序是实时的，按说这个循环也就&lt;script type=&quot;math/tex&quot;&gt;10^6&lt;/script&gt;，应该能在一帧（大约0.03~0.05秒）内搞定的，但没想到，实际用时达到了接近一秒，直接导致了程序不可用。&lt;/p&gt;

&lt;p&gt;最终，我发现，NumPy里其实也是可以像MATLAB一样，直接拿矩阵当index来操作的，也就是直接这样写&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;问题解决之后，感觉这是个很蠢的问题，其主要原因还是自己对NumPy，以及Python的不熟悉。&lt;/p&gt;

&lt;p&gt;来源：&lt;a href=&quot;https://stackoverflow.com/questions/29562822/numpy-2d-array-assignment-with-2d-value-and-indices-arrays&quot;&gt;numpy 2D array assignment with 2D value and indices arrays&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;合并&quot;&gt;合并&lt;/h3&gt;

&lt;p&gt;append&lt;/p&gt;

&lt;p&gt;需要复制，耗费大量内存和时间&lt;/p&gt;

&lt;p&gt;concatenate&lt;/p&gt;

&lt;p&gt;例子&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadtxt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'bruno silveira.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loadtxt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'domarys.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concatenate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;输出&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(6, 31)
(5, 31)
(11, 31)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;open-cv&quot;&gt;Open-CV&lt;/h1&gt;

&lt;h2 id=&quot;切换版本&quot;&gt;切换版本&lt;/h2&gt;

&lt;p&gt;首先在这个&lt;a href=&quot;https://www.lfd.uci.edu/~gohlke/pythonlibs/#opencv&quot;&gt;网站&lt;/a&gt;找到想要的版本，下载&lt;code class=&quot;highlighter-rouge&quot;&gt;whl&lt;/code&gt;文件，之后执行&lt;code class=&quot;highlighter-rouge&quot;&gt;pip install xxx.whl&lt;/code&gt;即可。&lt;/p&gt;

&lt;h1 id=&quot;scikit-learn&quot;&gt;scikit-learn&lt;/h1&gt;

&lt;h2 id=&quot;svm&quot;&gt;SVM&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.svm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;requests&quot;&gt;requests&lt;/h1&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="Python" /><category term="笔记" /><summary type="html">这是个笔记，并非教程。 前言 这里将记录个人在写Python的过程中遇到的各种问题，以及解决方法。如果大家发现哪里写错了，过时了，或有别的任何问题，欢迎在下方评论或发邮件告知。</summary></entry><entry><title type="html">Alan的C++笔记</title><link href="http://localhost:4000/2018/07/14/alan-C++.html" rel="alternate" type="text/html" title="Alan的C++笔记" /><published>2018-07-14T00:00:00+08:00</published><updated>2018-07-14T00:00:00+08:00</updated><id>http://localhost:4000/2018/07/14/alan-C++</id><content type="html" xml:base="http://localhost:4000/2018/07/14/alan-C++.html">&lt;p class=&quot;warning&quot;&gt;这是个笔记，并非教程。&lt;/p&gt;

&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;这里将记录个人在写C++的过程中遇到的各种问题，以及解决方法。如果大家发现哪里写错了，过时了，或有别的任何问题，欢迎在下方评论或发邮件告知。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;字符串相关&quot;&gt;字符串相关&lt;/h1&gt;
&lt;h2 id=&quot;向需要stdstring的函数传递char&quot;&gt;向需要&lt;code class=&quot;highlighter-rouge&quot;&gt;std::string&lt;/code&gt;的函数传递&lt;code class=&quot;highlighter-rouge&quot;&gt;char&lt;/code&gt;&lt;/h2&gt;
&lt;h3 id=&quot;问题描述&quot;&gt;问题描述&lt;/h3&gt;
&lt;p&gt;有一个函数类似于&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;st&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;但是，我在调用的时候只是想传递一个字符给它，存在一个&lt;code class=&quot;highlighter-rouge&quot;&gt;char&lt;/code&gt;类型的变量里&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;但这样写是不行的，因为类型不匹配。
如果是在别的地方，&lt;code class=&quot;highlighter-rouge&quot;&gt;char&lt;/code&gt;类型转&lt;code class=&quot;highlighter-rouge&quot;&gt;std::string&lt;/code&gt;类型可以用&lt;code class=&quot;highlighter-rouge&quot;&gt;std::string(ch)&lt;/code&gt;来进行，但在这里不行。&lt;/p&gt;
&lt;h3 id=&quot;解决方法&quot;&gt;解决方法&lt;/h3&gt;
&lt;p&gt;在stackoverflow上找到了解决方案：&lt;a href=&quot;https://stackoverflow.com/questions/24530144/how-to-pass-a-char-to-a-function-expecting-a-string&quot;&gt;How to pass a char to a function expecting a string&lt;/a&gt;
&lt;a href=&quot;https://stackoverflow.com/users/204847/mike-seymour&quot;&gt;Mike Seymour&lt;/a&gt;的回答获得了最高赞同，对其翻译如下：
首先，C++中没有&lt;code class=&quot;highlighter-rouge&quot;&gt;char&lt;/code&gt;到&lt;code class=&quot;highlighter-rouge&quot;&gt;std::string&lt;/code&gt;中的隐式类型转换（&lt;a href=&quot;https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.cbclx01/implicit_conversion_sequences.htm&quot;&gt;implicit conversion&lt;/a&gt;）。因此，你必须使用一个合适的构造函数，这个构造函数需要两个参数，用法如下：&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;或者，从&lt;code class=&quot;highlighter-rouge&quot;&gt;c++11&lt;/code&gt;开始，可以借助初始化表（initialiser list）&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// 如果test函数的重载没有疑义&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;'a'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// 如果你需要指明类型&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;eigen库--ligigl库&quot;&gt;Eigen库 &amp;amp;&amp;amp; ligigl库&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;Eigen is a C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;libigl is a simple C++ geometry processing library&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;vector-以及-matrix-类型&quot;&gt;Vector 以及 Matrix 类型&lt;/h2&gt;

&lt;p&gt;官方文档：&lt;a href=&quot;http://eigen.tuxfamily.org/dox/group__TutorialMatrixClass.html&quot;&gt;The Matrix class&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Eigen提供了非常多的类来描述向量和矩阵，然而他们都来自&lt;strong&gt;相同的&lt;/strong&gt;模板类&lt;code class=&quot;highlighter-rouge&quot;&gt;Matrix&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;这些类的命名方式为&lt;code class=&quot;highlighter-rouge&quot;&gt;Matrix(N)(T)&lt;/code&gt;或&lt;code class=&quot;highlighter-rouge&quot;&gt;Vector(N)(T)&lt;/code&gt;。其中&lt;code class=&quot;highlighter-rouge&quot;&gt;(N)&lt;/code&gt;代表维度，&lt;code class=&quot;highlighter-rouge&quot;&gt;(T)&lt;/code&gt;代表类型。例如，&lt;code class=&quot;highlighter-rouge&quot;&gt;Matrix3f&lt;/code&gt;表示的就是一个3×3的&lt;code class=&quot;highlighter-rouge&quot;&gt;float&lt;/code&gt;类型的矩阵。&lt;/p&gt;

&lt;p&gt;符号&lt;code class=&quot;highlighter-rouge&quot;&gt;(N)&lt;/code&gt;除了数字之外，还可以是&lt;code class=&quot;highlighter-rouge&quot;&gt;X&lt;/code&gt;，表示不能提前确定其大小，例如&lt;code class=&quot;highlighter-rouge&quot;&gt;VectorXf&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;符号&lt;code class=&quot;highlighter-rouge&quot;&gt;(T)&lt;/code&gt;的类型（我见过的）有三种：&lt;code class=&quot;highlighter-rouge&quot;&gt;i&lt;/code&gt;表示&lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;f&lt;/code&gt;表示&lt;code class=&quot;highlighter-rouge&quot;&gt;float&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt;表示&lt;code class=&quot;highlighter-rouge&quot;&gt;double&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;以下是一些定义变量的例子&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Eigen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Matrix3f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MatrixXf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MatrixXf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VectorXf&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vector2d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vector3d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;7.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vector4d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;7.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;8.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;matlab-to-eigen-igl&quot;&gt;MATLAB to Eigen (&amp;amp;&amp;amp;igl)&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://igl.ethz.ch/projects/libigl/matlab-to-eigen.html&quot;&gt;《MATLAB to Eigen table》&lt;/a&gt;是供熟悉MATLAB的人参考的一个对照表。如果你熟悉MATLAB的话，可以通过这个对照表查找如果用Eigen和Ligigl实现MATLAB对应的操作。&lt;/p&gt;

&lt;h1 id=&quot;visual-studio-2015&quot;&gt;Visual Studio 2015&lt;/h1&gt;

&lt;h2 id=&quot;快捷键&quot;&gt;快捷键&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;添加注释&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl&lt;/code&gt;+&lt;code class=&quot;highlighter-rouge&quot;&gt;k&lt;/code&gt;+&lt;code class=&quot;highlighter-rouge&quot;&gt;c&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;删除注释&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ctrl&lt;/code&gt;+&lt;code class=&quot;highlighter-rouge&quot;&gt;k&lt;/code&gt;+&lt;code class=&quot;highlighter-rouge&quot;&gt;u&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="C++" /><category term="笔记" /><summary type="html">这是个笔记，并非教程。 前言 这里将记录个人在写C++的过程中遇到的各种问题，以及解决方法。如果大家发现哪里写错了，过时了，或有别的任何问题，欢迎在下方评论或发邮件告知。</summary></entry><entry><title type="html">哈工大教学评价随机选择脚本</title><link href="http://localhost:4000/2018/06/08/jwts.html" rel="alternate" type="text/html" title="哈工大教学评价随机选择脚本" /><published>2018-06-08T00:00:00+08:00</published><updated>2018-06-08T00:00:00+08:00</updated><id>http://localhost:4000/2018/06/08/jwts</id><content type="html" xml:base="http://localhost:4000/2018/06/08/jwts.html">&lt;h1 id=&quot;背景&quot;&gt;背景&lt;/h1&gt;

&lt;p&gt;又是一年教学评价，每次教学评价其实一开始挺想给每个老师一个公正的评价的。但无奈那个教评系统太烦了，有一万个需要选的地方，“5”和“实验未开出”、“个人未听课”离得超级近，这两个天选之选项一旦误选，整行都会变成同样的。而且我记得我前两天明明评过教了，不知道怎么回事那个评教就神奇的消失了，还得重新评一次。&lt;/p&gt;

&lt;p&gt;这次我坚决不再一个一个点了，花了评教十倍的时间，学了一些&lt;code class=&quot;highlighter-rouge&quot;&gt;JQuery&lt;/code&gt;的知识，写了一个&lt;a href=&quot;http://tampermonkey.net/&quot;&gt;油猴（tampermonkey）&lt;/a&gt;脚本，帮我点每一个&lt;code class=&quot;highlighter-rouge&quot;&gt;select&lt;/code&gt;，并且为了表示不满，我没有默认点最好的，而是全部随机。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/无奈.jpg&quot; alt=&quot;无奈&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;代码&quot;&gt;代码&lt;/h1&gt;

&lt;p&gt;这个代码其实没什么难度，写了这么久主要是因为自己啥都不懂。是真的啥都不懂，我花了两个小时时候才明白原来我一直在写的都是&lt;code class=&quot;highlighter-rouge&quot;&gt;JQuery&lt;/code&gt;库的东西。&lt;/p&gt;

&lt;p&gt;后面（误以为）发现教务处的破网站还是动态加载的，直接获取还获取不到，就查了好多获取动态标签的方法。但后来发现，原来教务处就是在&lt;code class=&quot;highlighter-rouge&quot;&gt;iframe&lt;/code&gt;中又打开了个网页，其实是可以直接获取到的。&lt;/p&gt;

&lt;p&gt;代码的具体实现注释里讲的就比较清楚了。这个脚本只在&lt;code class=&quot;highlighter-rouge&quot;&gt;Chrome&lt;/code&gt;的&lt;code class=&quot;highlighter-rouge&quot;&gt;Tampermonkey&lt;/code&gt;插件中试过，至少在我这里是能用的。&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ==UserScript==&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @name         HIT random selector&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @namespace    http://tampermonkey.net/&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @version      0.1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @description  教学评价那里有一万个选择框，太烦了，这个脚本一键随机选择&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @author       Alan&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @match        http://jwts.hit.edu.cn/*&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @require      http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// @grant        GM_xmlhttpRequest&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ==/UserScript==&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//教务处系统外部是一个html，内部iframe又是一个html&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//该脚本会被执行两次，只有iframe里面的那一次是需要的&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//暂时用marginwidth判断就行&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'marginwidth'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)){&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//随便插一个按钮&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prepend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;button id='randomButton'&amp;gt;Random&amp;lt;/button&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//给按钮注册事件&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'#randomButton'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'click'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;select&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//获取所有的选择框&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wrong&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;其它&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-请选择-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;实验未开出&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;无法评价&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;教师未上课&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;个人未听课&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//这里存储所有不想选的选项，如果你不想给1分，2分什么的，也可以加进去&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//对每个select进行操作&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'option'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//获取第i个select的所有option&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//初始化一个Array，里面存有可能被选的option的value&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//对每个第i个select的所有option进行操作&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;//第j个选项的text不在wrong数组中，且第j个选项的value不为空&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inArray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wrong&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//将value加入options&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//随机一个index&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//根据index设置select的option&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;用法&quot;&gt;用法&lt;/h1&gt;

&lt;p&gt;首先要下载安装支持油猴脚本的插件，&lt;a href=&quot;https://greasyfork.org/zh-CN&quot;&gt;Greasy Fork&lt;/a&gt;上列出了不同的浏览器有哪些插件可以下载。我这里用的就是&lt;a href=&quot;https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo&quot;&gt;油猴的Chrome插件&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;安装好插件后，添加新脚本，复制粘贴上面的代码即可。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jwts1.png&quot; alt=&quot;无奈&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如果不出意外的话，之后每次登陆教务处系统后，都会出现一个&lt;code class=&quot;highlighter-rouge&quot;&gt;Random&lt;/code&gt;按钮，这个按钮的作用就是把页面上的所有&lt;code class=&quot;highlighter-rouge&quot;&gt;select&lt;/code&gt;都随机一遍，不想选的内容可以在代码里添加。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/jwts2.png&quot; alt=&quot;无奈&quot; class=&quot;shadow&quot; /&gt;&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="哈工大" /><category term="教务处" /><category term="油猴" /><summary type="html">背景 又是一年教学评价，每次教学评价其实一开始挺想给每个老师一个公正的评价的。但无奈那个教评系统太烦了，有一万个需要选的地方，“5”和“实验未开出”、“个人未听课”离得超级近，这两个天选之选项一旦误选，整行都会变成同样的。而且我记得我前两天明明评过教了，不知道怎么回事那个评教就神奇的消失了，还得重新评一次。 这次我坚决不再一个一个点了，花了评教十倍的时间，学了一些JQuery的知识，写了一个油猴（tampermonkey）脚本，帮我点每一个select，并且为了表示不满，我没有默认点最好的，而是全部随机。</summary></entry><entry><title type="html">在VS中用C语言操作MySQL</title><link href="http://localhost:4000/2018/06/07/c-mysql.html" rel="alternate" type="text/html" title="在VS中用C语言操作MySQL" /><published>2018-06-07T00:00:00+08:00</published><updated>2018-06-07T00:00:00+08:00</updated><id>http://localhost:4000/2018/06/07/c-mysql</id><content type="html" xml:base="http://localhost:4000/2018/06/07/c-mysql.html">&lt;p&gt;根据学校数据库课程的实验要求，需要使用C语言进行数据库的查询操作。这篇文章&lt;strong&gt;不介绍&lt;/strong&gt;如何做实验，只讲如何配环境，配Visual Studio 2015的环境。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;建立工程&quot;&gt;建立工程&lt;/h1&gt;

&lt;p&gt;首先，通过VS建立一个空项目，新建完项目后，要在属性页进行三处设置。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;项目属性→配置属性→C/C++→常规→附加包含目录&lt;/strong&gt;中添加mysql安装目录下的&lt;strong&gt;include文件夹&lt;/strong&gt;，这里面包含了mysql.h文件
&lt;img src=&quot;/assets/images/c-mysql-1.png&quot; alt=&quot;c-mysql-1&quot; class=&quot;border&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;项目属性→配置属性→链接器→常规→附加库目录&lt;/strong&gt;中添加mysql安装目录下的&lt;strong&gt;lib文件夹&lt;/strong&gt;，这里面包含了链接所需要的lib文件
&lt;img src=&quot;/assets/images/c-mysql-2.png&quot; alt=&quot;c-mysql-1&quot; class=&quot;border&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;项目属性→配置属性→链接器→输入→附加依赖项&lt;/strong&gt;中添加lib文件夹中的&lt;strong&gt;libmysql.lib文件&lt;/strong&gt;
&lt;img src=&quot;/assets/images/c-mysql-3.png&quot; alt=&quot;c-mysql-1&quot; class=&quot;border&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;运行后，会发现找不到&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysql.dll&lt;/code&gt;，我的解决方法是将lib文件夹中的&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysql.dll&lt;/code&gt;复制到VS编译的exe文件同目录下。除此之外暂时没找到更好的方法。&lt;/p&gt;

&lt;p&gt;mysql同时提供了&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysqld.lib&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysql.lib&lt;/code&gt;，根据往常的习惯，在debug模式下应该导入&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysqld.lib&lt;/code&gt;。但这样mysql连接一直初始化失败，后来在stackoverflow上进行查询，才发现这是&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysqld.lib&lt;/code&gt;经常出现的问题，因此最终改回了&lt;code class=&quot;highlighter-rouge&quot;&gt;libmysql.lib&lt;/code&gt;。&lt;/p&gt;

&lt;h1 id=&quot;编码问题&quot;&gt;编码问题&lt;/h1&gt;

&lt;p&gt;VS的默认编码是&lt;code class=&quot;highlighter-rouge&quot;&gt;gbk-2312&lt;/code&gt;，而我想要访问的数据库的编码设置为&lt;code class=&quot;highlighter-rouge&quot;&gt;utf8&lt;/code&gt;，因此，直接进行查询操作后，返回的结果输出是乱码。&lt;/p&gt;

&lt;p&gt;最开始想到的是cmd窗口的问题，在stackoverflow上进行查询，得到了如下的解决方案&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;windows.h&amp;gt;
#pragma execution_character_set( &quot;utf-8&quot; )
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;…&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SetConsoleOutputCP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;65001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//设置输出代码页为65001（utf8）&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这种方法相当于修改了cmd窗口的编码方式，因此在输出的时候能够正确输出utf8编码的结果了。&lt;/p&gt;

&lt;p&gt;但后面又遇到了问题，程序最终执行的时候，需要在cmd窗口调用程序，通过argv传递参数，在这个传递参数的时候，中文又会出现乱码，导致查询结果为空（因为没有相等的字符串）。这个问题可能遇到的人比较少，没有搜索到解决的方法。&lt;/p&gt;

&lt;p&gt;因此最终换了一种解决方案，发现mysql在连接时，可以设置期望的编码格式，代码如下：&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// 设置数据库默认字符集&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysql_set_character_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysql_conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;gbk&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;fprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stderr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;错误, %s/n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mysql_conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;这样直接将期望的字符集设置成gbk，就不再需要VS方面做任何修改了，数据库的代码也不会被改变。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="C" /><category term="MySQL" /><category term="配环境" /><category term="数据库" /><category term="哈工大" /><summary type="html">根据学校数据库课程的实验要求，需要使用C语言进行数据库的查询操作。这篇文章不介绍如何做实验，只讲如何配环境，配Visual Studio 2015的环境。</summary></entry><entry><title type="html">更改博客模板</title><link href="http://localhost:4000/2018/06/06/new-template.html" rel="alternate" type="text/html" title="更改博客模板" /><published>2018-06-06T00:00:00+08:00</published><updated>2018-06-06T00:00:00+08:00</updated><id>http://localhost:4000/2018/06/06/new-template</id><content type="html" xml:base="http://localhost:4000/2018/06/06/new-template.html">&lt;h1 id=&quot;前言&quot;&gt;前言&lt;/h1&gt;

&lt;p&gt;之前这个博客使用的是一个极简的模板&lt;a href=&quot;https://heiswayi.nrird.com/the-plain/&quot;&gt;The plain&lt;/a&gt;的老版本，现在事实上已经稍微丰富了一点点了，在那个老版本里，除了展示最基础的markdown之外，几乎什么都不支持。于是想换一个使用方便，且功能较全的模板。&lt;/p&gt;

&lt;p&gt;经过一段时间的搜索，觉得&lt;a href=&quot;https://tianqi.name/jekyll-TeXt-theme/&quot;&gt;TeXt Theme&lt;/a&gt;这个模板写的很好，而且应该是国人写的，配有&lt;a href=&quot;https://tianqi.name/jekyll-TeXt-theme/docs/zh/quick-start&quot;&gt;中文文档&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;今天写这篇博文，主要是记录一下在修改到此模板的过程中遇到的各种问题，以及最终的解决方式。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;配环境&quot;&gt;配环境&lt;/h1&gt;

&lt;h2 id=&quot;初次启动失败&quot;&gt;初次启动失败&lt;/h2&gt;

&lt;h3 id=&quot;could-not-find-gem-jemoji--08-x64-mingw32&quot;&gt;Could not find gem ‘jemoji (~&amp;gt; 0.8) x64-mingw32’&lt;/h3&gt;

&lt;p&gt;首先，从GitHub上clone下来整个仓库后，按照文档，应该执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle exec jekyll serve&lt;/code&gt;命令来启动服务器。但我再尝试的时候发现这个会报“缺少jemoji”的错误，根据Stack Overflow上&lt;a href=&quot;https://stackoverflow.com/questions/45301378/bundler-could-not-find-compatible-versions-for-gem-jemoji-when-bundle-exec-j&quot;&gt;一个问题&lt;/a&gt;的答案，在你第一次执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle exec jekyll serve&lt;/code&gt;命令之前，应该先执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle install&lt;/code&gt;指令。&lt;/p&gt;

&lt;h3 id=&quot;bundle-install-特别慢没反应&quot;&gt;bundle install 特别慢/没反应&lt;/h3&gt;

&lt;p&gt;在执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle install&lt;/code&gt;后，界面就一直没有反应，也不知道是否已经开始下载，搜索后发现这是因为该指令默认的下载地址是&lt;a href=&quot;https://rubygems.org/&quot;&gt;https://rubygems.org/&lt;/a&gt;（我的老版本实际是&lt;a href=&quot;http://rubygems.org/&quot;&gt;http://rubygems.org/&lt;/a&gt;，这个地址在墙外，因此速度非常非常慢。&lt;/p&gt;

&lt;p&gt;一些较老的博客会给出将地址修改为&lt;a href=&quot;https://ruby.taobao.org/&quot;&gt;https://ruby.taobao.org/&lt;/a&gt;的解决方法，但根据该网站的告示，这个网站已经不再维护，RubyGems 镜像的管理工作已经将交由&lt;a href=&quot;https://gems.ruby-china.org/&quot;&gt;Ruby China&lt;/a&gt;负责，相应的换sources的教程在&lt;a href=&quot;https://gems.ruby-china.org/&quot;&gt;Ruby China的官网&lt;/a&gt;上有介绍。&lt;/p&gt;

&lt;h3 id=&quot;gem-update-system-特别慢没反应&quot;&gt;gem update –system 特别慢/没反应&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://gems.ruby-china.org/&quot;&gt;Ruby China&lt;/a&gt;建议先升级RubyGems版本，然而这一步需要翻墙，我尝试把Shadowsocks开到了全局模式，但是并没有什么反应，或者说我没有耐心等到他有反应，于是决定手动安装新版本。&lt;/p&gt;

&lt;p&gt;记不清是从哪找到的网站，&lt;a href=&quot;https://rubyinstaller.org/downloads/&quot;&gt;Ruby Installer for Windows&lt;/a&gt;， 直接下载了最新版本，下载完运行，安装器不会检测已有的版本，但根据选项，它会自动配置环境变量，因此猜测安装完成后，环境变量就已经被换为新版本了。&lt;/p&gt;

&lt;p&gt;安装完成后，在&lt;strong&gt;git bash&lt;/strong&gt;中仍为老版本，打开cmd窗口，输入&lt;code class=&quot;highlighter-rouge&quot;&gt;ruby --version&lt;/code&gt;，发现已经是新版本，推测有些改动重启后才能生效，于是重启电脑，再次在&lt;strong&gt;git bash&lt;/strong&gt;中检测ruby版本，已经切换到了新版本。&lt;/p&gt;

&lt;h3 id=&quot;ssl证书错误&quot;&gt;SSL证书错误&lt;/h3&gt;

&lt;p&gt;将&lt;a href=&quot;https://gems.ruby-china.org/&quot;&gt;Ruby China&lt;/a&gt;的教程进行完，执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle install&lt;/code&gt;，这次反应非常快，说明网络已经通了，但果然报了&lt;strong&gt;SSL证书错误&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;首先，官网说的&lt;code class=&quot;highlighter-rouge&quot;&gt;~/.gemrc&lt;/code&gt;地址是Linux下的，在Windows下，应该是&lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Users\&amp;lt;你的用户名&amp;gt;&lt;/code&gt;（中文系统中&lt;code class=&quot;highlighter-rouge&quot;&gt;Users&lt;/code&gt;文件夹在资源管理器中显示为&lt;code class=&quot;highlighter-rouge&quot;&gt;用户&lt;/code&gt;）。&lt;/p&gt;

&lt;p&gt;在添加了&lt;code class=&quot;highlighter-rouge&quot;&gt;:ssl_verify_mode: 0&lt;/code&gt;一行后，报错信息发生了改变，但仍然是&lt;strong&gt;SSL证书错误&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ailurus_fulgens/article/details/54287621&quot;&gt;这篇博客&lt;/a&gt;给出了比较全面的解决方法。我最终的解决方法是添加环境变量，有一点需要强调的是这个环境变量添加的是&lt;strong&gt;文件&lt;/strong&gt;而不是文件夹或路径。&lt;/p&gt;

&lt;p&gt;之后执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle install&lt;/code&gt;，运行成功。&lt;/p&gt;

&lt;p&gt;执行&lt;code class=&quot;highlighter-rouge&quot;&gt;bundle exec jekyll serve&lt;/code&gt;，运行成功，能够打开网页。&lt;/p&gt;

&lt;h2 id=&quot;配置&quot;&gt;配置&lt;/h2&gt;

&lt;p&gt;这里的配置指的就是中文文档里面的配置那一小节。&lt;/p&gt;

&lt;h3 id=&quot;gitalk&quot;&gt;gitalk&lt;/h3&gt;

&lt;p&gt;在此强调，这里说的gitalk遇到的问题，是在配置&lt;a href=&quot;https://tianqi.name/jekyll-TeXt-theme/&quot;&gt;TeXt Theme&lt;/a&gt;模板的gitalk部分时遇到的问题，与真正的gitalk关系并不大。&lt;/p&gt;

&lt;h4 id=&quot;结论&quot;&gt;结论&lt;/h4&gt;

&lt;p&gt;感觉文档中这里具体怎么写说的并不是很清楚，下面先放上一些结论，后从源代码的角度说一下有些结论的原因。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;注册GitHub Application时，Homepage URL填博客地址即可，Authorization callback URL可以不填，缺省会被自动填为和Homepage URL一样。&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;中gitalk部分不需要加任何的引号或括号&lt;/li&gt;
  &lt;li&gt;仓库名、用户名参考我下面的例子&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;admin&lt;/code&gt;是一个list，填法参考我下面的例子&lt;/li&gt;
  &lt;li&gt;必须在文章的YAML头信息中添加&lt;code class=&quot;highlighter-rouge&quot;&gt;key&lt;/code&gt;字段，该文章才能有评论，key字段不能重复&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;例子&quot;&gt;例子&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;中：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;## Gitalk
# please refer to https://github.com/gitalk/gitalk for more info.
gitalk:
  clientID: 61***************b7 # GitHub Application Client ID
  clientSecret: 54************************************64 # GitHub Application Client Secret
  repository: AlanXue1997.github.io # GitHub repo
  owner: AlanXue1997 # GitHub repo owner
  admin: # Github repo owner and collaborators, only these guys can initialize github issues, IT IS A LIST.
    - AlanXue1997
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;本文章YAML头信息：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
layout: article
title: 更改博客模板
mathjax: true
tags: jekyll ruby 配环境
key: 2018-06-06-new-template
---
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;源代码分析&quot;&gt;源代码分析&lt;/h4&gt;

&lt;p&gt;首先，看一下&lt;code class=&quot;highlighter-rouge&quot;&gt;/_includes/comment.html&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-rhtml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
{%- if jekyll.environment != &quot;development&quot; -%}

  {%- if site.disqus.shortname -%}
    {%- include comment-providers/disqus.html -%}
  {%- elsif site.gitalk.clientID and site.gitalk.clientSecret and site.gitalk.repository and site.gitalk.owner and site.gitalk.admin -%}
    {%- include comment-providers/gitalk.html -%}
  {%- endif -%}

{%- endif -%}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;从第一行就可以看出，在开发环境中，comment里面的代码是不会被执行的，所以本地看不见gitalk是很正常的。&lt;/p&gt;

&lt;p&gt;gitalk相关的html文件存储在&lt;code class=&quot;highlighter-rouge&quot;&gt;/_includes/comment-providers/gitalk.html&lt;/code&gt;中，内容如下：&lt;/p&gt;

&lt;div class=&quot;language-rhtml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
{%- if page.key and
  site.gitalk.clientID and
	site.gitalk.clientSecret and
	site.gitalk.repository and
	site.gitalk.owner and
	site.gitalk.admin -%}

	{%- include snippets/get-sources.html -%}
	{%- assign _sources = __return -%}
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;js-gitalk-container&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
	{%- assign _admin = '' -%}
	{%- for adminId in site.gitalk.admin -%}
		{%- assign _admin = _admin | append: &quot;, '&quot; | append: adminId | append: &quot;'&quot; -%}
	{%- endfor -%}
	{%- assign last = _admin | size | minus: 1 -%}
	{%- assign _admin = _admin | slice: 2, last -%}
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Lazyload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'{{ _sources.gitalk.css }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Lazyload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;js&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'{{ _sources.gitalk.js }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gitalk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Gitalk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;clientID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ site.gitalk.clientID }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;clientSecret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ site.gitalk.clientSecret }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ site.gitalk.repository }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;owner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ site.gitalk.owner }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;admin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_admin&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}],&lt;/span&gt;
				&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ page.key }}'&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;gitalk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'js-gitalk-container'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;

{%- endif -%}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;首先，&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;script&amp;gt;&lt;/code&gt;中，代码中已经加了单引号，因此在写配置文件&lt;code class=&quot;highlighter-rouge&quot;&gt;_config.yml&lt;/code&gt;的时候并不需要加引号。其次，根据第一行，如果该文章没有key字段（&lt;code class=&quot;highlighter-rouge&quot;&gt;page.key&lt;/code&gt;），则此代码不会被执行，而 &lt;code class=&quot;highlighter-rouge&quot;&gt;page.key&lt;/code&gt;被赋值给了&lt;code class=&quot;highlighter-rouge&quot;&gt;gitalk.id&lt;/code&gt;（倒数第五行），用来唯一标识评论的id，需要保证每篇文章的评论id不同，因此需要为每个文章的YAML头信息添加不同的key字段。&lt;/p&gt;

&lt;h1 id=&quot;写本文遇到的问题&quot;&gt;写本文遇到的问题&lt;/h1&gt;

&lt;h2 id=&quot;ruby-template不能被正确高亮&quot;&gt;ruby template不能被正确高亮&lt;/h2&gt;

&lt;p&gt;这个问题本来就是写markdown时遇到的问题，想想现在要在markdown中把问题说清楚。。。难度太大了，如果有人遇到&lt;strong&gt;ruby template不能被正确高亮&lt;/strong&gt;或&lt;strong&gt;django template不能被正确高亮&lt;/strong&gt;，直接参考这个issue“&lt;a href=&quot;https://github.com/jekyll/jekyll/issues/281&quot;&gt;Highlight does not work with django templates #281&lt;/a&gt;”吧。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="jekyll" /><category term="ruby" /><category term="配环境" /><summary type="html">前言 之前这个博客使用的是一个极简的模板The plain的老版本，现在事实上已经稍微丰富了一点点了，在那个老版本里，除了展示最基础的markdown之外，几乎什么都不支持。于是想换一个使用方便，且功能较全的模板。 经过一段时间的搜索，觉得TeXt Theme这个模板写的很好，而且应该是国人写的，配有中文文档。 今天写这篇博文，主要是记录一下在修改到此模板的过程中遇到的各种问题，以及最终的解决方式。</summary></entry><entry><title type="html">DBSCAN</title><link href="http://localhost:4000/2017/03/10/DBSCAN.html" rel="alternate" type="text/html" title="DBSCAN" /><published>2017-03-10T00:00:00+08:00</published><updated>2017-03-10T00:00:00+08:00</updated><id>http://localhost:4000/2017/03/10/DBSCAN</id><content type="html" xml:base="http://localhost:4000/2017/03/10/DBSCAN.html">&lt;p&gt;参加了老师的一个项目，要搞劣质数据对机器学习算法的影响，我负责实现&lt;a href=&quot;https://zh.wikipedia.org/wiki/DBSCAN&quot;&gt;DBSCAN算法&lt;/a&gt;。&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;定义&quot;&gt;定义&lt;/h1&gt;

&lt;h3 id=&quot;参数&quot;&gt;参数&lt;/h3&gt;

&lt;p&gt;ε(eps)：邻域半径&lt;/p&gt;

&lt;p&gt;minPts：形成核心点最少的点数&lt;/p&gt;

&lt;h3 id=&quot;距离&quot;&gt;距离&lt;/h3&gt;

&lt;p&gt;在二维（每个数据只有两个属性）的情况下，使用欧氏距离(sqrt(x^2+y^2))就可以有很好的效果，但对于更高维度的数据，欧氏距离是不适用的。&lt;/p&gt;

&lt;h3 id=&quot;点的可达性&quot;&gt;点的可达性&lt;/h3&gt;

&lt;p&gt;如果点p在距离ε内有至少minPts个点,则点p被称为&lt;strong&gt;核心点(core point)&lt;/strong&gt;，p距离ε内的其他点被称为&lt;strong&gt;p的直接可达点(directly density-reachable point)&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;对于点p和q，如果存在一个序列{p1,p2,…,pn}，其中p1=p，pn=1，满足∀i∈N,i&amp;lt;n有pi+1是pi的直接可达点，则称q为&lt;strong&gt;p的可达点(density-reachable point)&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;对于点p和q，如果存在点o，p和q都是o的可达点，则称p和q是&lt;strong&gt;密度连接(density-connected)&lt;/strong&gt;的。&lt;/p&gt;

&lt;p&gt;如果点p不是任何点的可达点，则称p为&lt;strong&gt;局外点&lt;/strong&gt;。&lt;/p&gt;

&lt;h3 id=&quot;聚类&quot;&gt;聚类&lt;/h3&gt;

&lt;p&gt;一个聚类满足如下性质：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1.聚类中的任意两个点都是密度连接的。

2.聚类中的任意点的可达点仍属于这个聚类。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;算法&quot;&gt;算法&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;①对于每一个点，判断其是否为核心点&lt;/p&gt;

  &lt;p&gt;②新建一个聚类cluster&lt;/p&gt;

  &lt;p&gt;③找到一个没有被访问的点，放入cluster。如果所有店都被访问，则程序结束。&lt;/p&gt;

  &lt;p&gt;④根据cluster中点的可达点进行搜索，将搜索到的未被访问的点放入cluster，并标记为已访问。&lt;/p&gt;

  &lt;p&gt;⑤重复②&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;代码&quot;&gt;代码&lt;/h1&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;vector&amp;gt;
#include &amp;lt;algorithm&amp;gt;
#include &amp;lt;fstream&amp;gt;
#include &amp;lt;iostream&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define pointSet std::vector&amp;lt;point&amp;gt;
#define pointerSet std::vector&amp;lt;int&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define NOT_VISTED -1
#define WRITE_TO_FILE
#define ATTRIBUTIONS 4
&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define minPts 4
#define E 0.1
&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//it is actually squared e&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//amount of directly density-reachable points&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag_ans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;pointerSet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attributions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag_ans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NOT_VISTED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag_ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag_ans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//there is no sqrt() because E have been squared&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DBSCAN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;DBSCAN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifstream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;push_back&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attributions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;fin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;//To calcute ddr(amount directly density-reachable points) of every point and save ddrs(directly density-reachable points) for each CORE points&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calcDdr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;pointerSet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pointerSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;push_back&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minPts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//if point i is not a core point, we need not to know its directly density-reachable points&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DFS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NOT_VISTED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minPts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DFS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;calcDdr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NOT_VISTED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minPts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;DFS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#ifdef WRITE_TO_FILE
&lt;/span&gt;		&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ofstream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;output.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;fout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'\t'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;fout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'\t'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag_ans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;fout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#else
&lt;/span&gt;		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTRIBUTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#endif
&lt;/span&gt;	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;pointSet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;DBSCAN&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dbscan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DBSCAN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;dbscan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pause&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;效果&quot;&gt;效果&lt;/h1&gt;

&lt;p&gt;二维的情况，看起来聚类的结果还是很好的，由于只使用了四个属性中的两个，所以没有将原始数据的三个集合给区分出来，但明显能看出来将相近的点分成了同样的颜色（灰色代表噪声）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dbscan.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;但在高维数据上，使用欧氏距离计算密度的DBSCAN的效果就不是很好了，甚至可以说非常不好，例如我用的iris数据，如果将四个属性全用上，则不管怎么调整参数，都无法大致将数据分成三类，虽然四维图像无法显示，但从输出来看，结果跟上图是差不多了，有两类无法分开。&lt;/p&gt;</content><author><name>Alan Xue</name><email>xuezhonghao1997@gmail.com</email></author><category term="机器学习" /><category term="C++" /><summary type="html">参加了老师的一个项目，要搞劣质数据对机器学习算法的影响，我负责实现DBSCAN算法。</summary></entry></feed>